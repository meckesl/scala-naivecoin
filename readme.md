Scala port of https://lhartikk.github.io